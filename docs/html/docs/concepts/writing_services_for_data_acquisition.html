

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Integrate a Payload with the Data Acquisition Pipeline &mdash; Spot 2.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/bd-favicon.png"/>
  
  
  
    <link rel="canonical" href="https:://dev.bostondynamics.com/docs/concepts/writing_services_for_data_acquisition.html"/>
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../README.html">
          

          
            
            <img src="../../_static/bd-official-white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about_spot.html">About Spot</a></li>
<li class="toctree-l2"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="base_services.html">Base services</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_api_services.html">Developing API Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_acquisition_overview.html">Data Acquisition Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="faults.html">Faults</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry_and_frames.html">Geometry and Frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot_services.html">Robot services</a></li>
<li class="toctree-l2"><a class="reference internal" href="estop_service.html">E-Stop</a></li>
<li class="toctree-l2"><a class="reference internal" href="autonomy/README.html">Autonomy services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="autonomy/graphnav_tech_summary.html">Autonomy Technical Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/autonomous_navigation_code_examples.html">Autonomous navigation code examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/components_of_autonomous_navigation.html">Components of autonomous navigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/typical_autonomous_navigation_use_case.html">Typical autonomous navigation use case</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/autonomous_navigation_services.html">Autonomous navigation services</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/graphnav_service.html">GraphNav service</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/graphnav_map_structure.html">GraphNav map structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/initialization.html">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/localization.html">Localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/graphnav_and_robot_locomotion.html">GraphNav and robot locomotion</a></li>
<li class="toctree-l3"><a class="reference internal" href="autonomy/missions_service.html">Missions service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="choreography/README.html">Choreography</a><ul>
<li class="toctree-l3"><a class="reference internal" href="choreography/choreography_service.html">Choreography Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="choreography/move_reference.html">Move Reference Guide</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../python/README.html">Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/quickstart.html">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/understanding_spot_programming.html">Understanding Spot Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/examples/README.html">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/comms_test/README.html">Comms Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/data_acquisition_service/README.html">Data Acquisition Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/data_service/README.html">Data Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/directory/README.html">Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/cloud_upload/README.html">Cloud Upload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/estop/README.html">E-Stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/service_faults/README.html">Fault</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/fiducial_follow/README.html">Fiducial Follow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/frame_trajectory_command/README.html">Frame Trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/get_image/README.html">Get Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/get_mission_state/README.html">Get Mission State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/get_robot_state/README.html">Get Robot State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/get_robot_state_async/README.html">Get Robot State Async</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/get_world_objects/README.html">Get World Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/graph_nav_command_line/README.html">Graph Nav Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/graph_nav_view_map/README.html">Graph Nav View Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/hello_spot/README.html">Hello Spot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/logging/README.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/mission_question_answerer/README.html">Mission Question Anwerer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/mission_recorder/README.html">Mission Recorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/payloads/README.html">Payloads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/remote_mission_service/README.html">Remote Mission Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/replay_mission/README.html">Replay Mission</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/ricoh_theta/README.html">Ricoh Theta</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/self_registration/README.html">Self Registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/spot_cam/README.html">Spot CAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/spot_detect_and_follow/README.html">Spot Detect and Follow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/spot_light/README.html">Spot Light</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/stance/README.html">Stance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/spot_tensorflow_detector/README.html">Tensorflow Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/time_sync/README.html">Time Sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/upload_choreographed_sequence/README.html">Upload Choreographed Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/velodyne_client/README.html">Velodyne</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/visualizer/README.html">Visualizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/wasd/README.html">WASD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/web_cam_image_service/README.html">Web Cam Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/world_object_mutations/README.html">World Object Mutations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/world_object_with_image_coordinates/README.html">World Object With Image Coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/examples/xbox_controller/README.html">Xbox Controller</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../python/README.html">Python Reference Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/README.html">Client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/async_tasks.html">Async Tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/auth.html">Auth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/bddf.html">BDDF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/channel.html">Channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/command_line.html">Command</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/common.html">Common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/data_acquisition.html">Data Acquisition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/data_acquisition_plugin.html">Data Acquisition Plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/data_acquisition_plugin_service.html">Data Acquisition Plugin Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/data_acquisition_store.html">Data Acquisition Store</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/data_buffer.html">Data Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/data_service.html">Data Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/directory_registration.html">Directory Registration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/directory.html">Directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/docking.html">Docking</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/estop.html">E-Stop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/exceptions.html">Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/fault.html">Fault</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/frame_helpers.html">Frame Helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/graph_nav.html">Graph Nav</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/image.html">Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/lease.html">Lease</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/license.html">License</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/local_grid.html">Local Grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/log_annotation.html">Log Annotation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/math_helpers.html">Math Helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/payload_registration.html">Payload Registration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/payload.html">Payload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/point_cloud.html">Point Cloud</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/power.html">Power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/processors.html">Processors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/recording.html">Recording</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/robot_command.html">Robot Command</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/robot_id.html">Robot ID</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/robot.html">Robot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/robot_state.html">Robot State</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/sdk.html">SDK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/README.html">Spot CAM</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/audio.html">Audio</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/compositor.html">Compositor</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/health.html">Health</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/lighting.html">Lighting</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/media_log.html">Media Log</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/network.html">Network</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/power.html">Power</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/ptz.html">PTZ</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/streamquality.html">Stream Quality</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_cam/version.html">Version</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/spot_check.html">Spot Check</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/time_sync.html">Time Sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/token_cache.html">Token Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/token_manager.html">Token Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/util.html">Util</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/world_object.html">World Object</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python/bosdyn-core/src/bosdyn/README.html">Core</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-core/src/bosdyn/geometry.html">Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-core/src/bosdyn/util.html">Util</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python/bosdyn-mission/src/bosdyn/mission/README.html">Mission</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-mission/src/bosdyn/mission/client.html">Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-mission/src/bosdyn/mission/constants.html">Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-mission/src/bosdyn/mission/exceptions.html">Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-mission/src/bosdyn/mission/remote_client.html">Remote Client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-mission/src/bosdyn/mission/server_util.html">Server Util</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-mission/src/bosdyn/mission/util.html">Util</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python/bosdyn-choreography-client/src/bosdyn/choreography/client/README.html">Choreography</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/bosdyn-choreography-client/src/bosdyn/choreography/client/choreography.html">Choreogrpahy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../payload/README.html">Payloads</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../payload/payload_configuration_requirements.html">Payload configuration requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../payload/mechanical_interfaces.html">Mechanical interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../payload/robot_mounting_rails.html">Robot mounting rails</a></li>
<li class="toctree-l2"><a class="reference internal" href="../payload/guidelines_for_robust_payload_design.html">Guidelines for robust payload design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../payload/robot_electrical_interface.html">Robot electrical interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../payload/configuring_payload_software.html">Configuring payload software</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../protos/README.html">API Protocol</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../protos/style_guide.html">Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../protos/bosdyn/api/README.html">Proto Reference Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html">auth.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#auth-service-proto">auth_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#basic-command-proto">basic_command.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#bddf-proto">bddf.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-acquisition-proto">data_acquisition.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-acquisition-plugin-service-proto">data_acquisition_plugin_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-acquisition-service-proto">data_acquisition_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-acquisition-store-proto">data_acquisition_store.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-acquisition-store-service-proto">data_acquisition_store_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-buffer-proto">data_buffer.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-buffer-service-proto">data_buffer_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-chunk-proto">data_chunk.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-index-proto">data_index.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#data-service-proto">data_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#directory-proto">directory.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#directory-registration-proto">directory_registration.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#directory-registration-service-proto">directory_registration_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#directory-service-proto">directory_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#docking-docking-proto">docking/docking.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#docking-docking-service-proto">docking/docking_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#estop-proto">estop.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#estop-service-proto">estop_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#fault-service-proto">fault_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#full-body-command-proto">full_body_command.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#geometry-proto">geometry.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#graph-nav-graph-nav-proto">graph_nav/graph_nav.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#graph-nav-graph-nav-service-proto">graph_nav/graph_nav_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#graph-nav-map-proto">graph_nav/map.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#graph-nav-nav-proto">graph_nav/nav.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#graph-nav-recording-proto">graph_nav/recording.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#graph-nav-recording-service-proto">graph_nav/recording_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#header-proto">header.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#image-proto">image.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#image-service-proto">image_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#lease-proto">lease.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#lease-service-proto">lease_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#license-proto">license.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#license-service-proto">license_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#local-grid-proto">local_grid.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#local-grid-service-proto">local_grid_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#log-annotation-proto">log_annotation.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#log-annotation-service-proto">log_annotation_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#mission-mission-proto">mission/mission.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#mission-mission-service-proto">mission/mission_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#mission-nodes-proto">mission/nodes.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#mission-remote-proto">mission/remote.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#mission-remote-service-proto">mission/remote_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#mission-util-proto">mission/util.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#mobility-command-proto">mobility_command.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#parameter-proto">parameter.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#payload-proto">payload.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#payload-registration-proto">payload_registration.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#payload-registration-service-proto">payload_registration_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#payload-service-proto">payload_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#point-cloud-proto">point_cloud.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#point-cloud-service-proto">point_cloud_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#power-proto">power.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#power-service-proto">power_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#robot-command-proto">robot_command.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#robot-command-service-proto">robot_command_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#robot-id-proto">robot_id.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#robot-id-service-proto">robot_id_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#robot-state-proto">robot_state.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#robot-state-service-proto">robot_state_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#service-fault-proto">service_fault.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-robot-command-proto">spot/robot_command.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-spot-check-proto">spot/spot_check.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-spot-check-service-proto">spot/spot_check_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-led-proto">spot_cam/LED.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-audio-proto">spot_cam/audio.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-camera-proto">spot_cam/camera.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-compositor-proto">spot_cam/compositor.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-health-proto">spot_cam/health.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-logging-proto">spot_cam/logging.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-network-proto">spot_cam/network.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-power-proto">spot_cam/power.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-ptz-proto">spot_cam/ptz.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-service-proto">spot_cam/service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-streamquality-proto">spot_cam/streamquality.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#spot-cam-version-proto">spot_cam/version.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#synchronized-command-proto">synchronized_command.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#time-range-proto">time_range.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#time-sync-proto">time_sync.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#time-sync-service-proto">time_sync_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#trajectory-proto">trajectory.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#world-object-proto">world_object.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#world-object-service-proto">world_object_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../protos/bosdyn/api/proto_reference.html#standard-types">Standard Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../choreography_protos/bosdyn/api/README.html">Choreography Proto Reference Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../choreography_protos/bosdyn/api/choreography_reference.html">spot/choreography_params.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../choreography_protos/bosdyn/api/choreography_reference.html#spot-choreography-sequence-proto">spot/choreography_sequence.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../choreography_protos/bosdyn/api/choreography_reference.html#spot-choreography-service-proto">spot/choreography_service.proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../choreography_protos/bosdyn/api/choreography_reference.html#standard-types">Standard Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/boston-dynamics/spot-sdk">SDK Repository</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../README.html">Spot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../README.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Integrate a Payload with the Data Acquisition Pipeline</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!--
Copyright (c) 2020 Boston Dynamics, Inc.  All rights reserved.

Downloading, reproducing, distributing or otherwise using the SDK Software
is subject to the terms and conditions of the Boston Dynamics Software
Development Kit License (20191101-BDSDK-SL).
--><div class="section" id="integrate-a-payload-with-the-data-acquisition-pipeline">
<h1>Integrate a Payload with the Data Acquisition Pipeline<a class="headerlink" href="#integrate-a-payload-with-the-data-acquisition-pipeline" title="Permalink to this headline">¶</a></h1>
<p>The 2.1 release focuses on simplifying the integration of sensing payloads with the robot by creating the data acquisition pipeline. This document provides an overview of how a developer can write the necessary API services to integrate their sensor. The data acquisition pipeline will work with any payload, however different development steps are taken for a payload which collects image data (e.g. a 360 camera) and a payload which collects other data types and formats (e.g. a lidar or gas sensor).</p>
<div class="section" id="camera-payloads">
<h2>Camera Payloads<a class="headerlink" href="#camera-payloads" title="Permalink to this headline">¶</a></h2>
<p>To integrate a camera payload which outputs image data in a known format (e.g. raw bytes or JPEG) with the data acquisition pipeline, a developer needs to implement an <a class="reference external" href="../../protos/bosdyn/api/proto_reference.html#image-service-proto">ImageService</a>.</p>
<p>The data acquisition service will automatically recognize any directory-registered image services, create <code class="docutils literal notranslate"><span class="pre">ImageAcquistionCapabilities</span></code> for the image sources, and be able to collect image data for each service using the standard <code class="docutils literal notranslate"><span class="pre">ImageService</span></code> RPCs. For a camera payload, a developer will need to implement an image servicer class, which will inherit from <code class="docutils literal notranslate"><span class="pre">image_service_pb2_grpc.ImageServiceservicer</span></code> and must include the following RPCs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ListImageSources</span></code> RPC: Outputs the image source names available and different parameters associated with each image source. For example, if a camera has a fisheye image and an undistorted image, then both can be listed as image sources in the service and queried for separately.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GetImage</span></code> RPC: retrieves images, based on the image source requested, from the payload using the camera’s API (e.g. OpenCV) and converts them into the <code class="docutils literal notranslate"><span class="pre">bosdyn.api.Image</span></code> proto message to be returned by the service. This RPC is meant to complete “quickly” when communicating with the payload and returning the collected images. If the RPC cannot complete quickly, it is recommended that a data acquisition plugin service is used to communicate with the camera payload and collect data as a <code class="docutils literal notranslate"><span class="pre">DataAcquisitionCapability</span></code>.</p>
<ul>
<li><p>Tip:  Create a second class which fetches images from the payload and keeps a buffer of these images to reduce latency when responding to the RPC.</p></li>
<li><p>Tip: The tablet makes requests for JPEG formatted images, so this RPC must at least respond to a jpeg format request to ensure the camera payload can be viewed on the tablet.</p></li>
</ul>
</li>
</ul>
<div class="section" id="example-image-services">
<h3>Example Image Services<a class="headerlink" href="#example-image-services" title="Permalink to this headline">¶</a></h3>
<p>There are two SDK examples showing <code class="docutils literal notranslate"><span class="pre">ImageService</span></code> implementations: a <a class="reference internal" href="../../python/examples/web_cam_image_service/README.html"><span class="doc">USB web camera</span></a>, and the <a class="reference internal" href="../../python/examples/ricoh_theta/README.html"><span class="doc">Ricoh Theta camera</span></a>.</p>
</div>
</div>
<div class="section" id="non-image-payloads">
<h2>Non-image Payloads<a class="headerlink" href="#non-image-payloads" title="Permalink to this headline">¶</a></h2>
<p>To integrate a payload which outputs a different, non-image format of data with the data acquisition pipeline, a developer needs to implement a <a class="reference external" href="../../protos/bosdyn/api/proto_reference.html#data-acquisition-plugin-service-proto">DataAcquisitionPluginService</a>.</p>
<p>A directory-registered DataAcquisitionPluginService will be automatically recognized by the data acquisition service on robot. The plugin service will collect the necessary payload data to respond to requests for its specific data captures from the data acquisition service. To simplify the implementation of a plugin service, a set of base plugin service helper functions are provided in <a class="reference internal" href="../../python/bosdyn-client/src/bosdyn/client/data_acquisition_plugin_service.html"><span class="doc">data_acquisition_plugin_service.py</span></a>.
The plugin service can be created with the <code class="docutils literal notranslate"><span class="pre">DataAcquisitionPluginService</span></code> class, which is a helper class that will manage state and respond to the RPCs required of a plugin service. The constructor of the plugin service helper class requires a developer to provide 1) a list of the data capabilities that the service can collect data, and 2) a function to collect this data.</p>
<div class="section" id="data-capabilities-list">
<h3>Data Capabilities List<a class="headerlink" href="#data-capabilities-list" title="Permalink to this headline">¶</a></h3>
<p>For each piece of data that will be collected from the payload, the plugin service must specify:</p>
<ul class="simple">
<li><p>Name: uniquely identifies which piece of data will be collected.</p></li>
<li><p>Description: a short, human-readable description of what data is being collected. This description will be displayed on the tablet when configuring data collection actions during teleop and autowalk.</p></li>
<li><p>Channel name: a string that will be associated with all data collected and stored by this plugin service in the data buffer.</p>
<ul>
<li><p>It is recommended to put different kinds of captures on different channels.  If you want to store multiple pieces of data on the same channel during the same capture action, please set the <code class="docutils literal notranslate"><span class="pre">data_name</span></code> in the <code class="docutils literal notranslate"><span class="pre">DataIdentifier</span></code>, so that the pieces of data can still be uniquely identified.</p></li>
</ul>
</li>
</ul>
<p>Using this information, the data acquisition plugin will create a list of capabilities, which are <code class="docutils literal notranslate"><span class="pre">Capability(name,</span> <span class="pre">description,</span> <span class="pre">channel_name)</span></code>. For example, a plugin collecting laser scan data that can be both sparse and dense would have the following capabilities list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>kCapabilities = [Capability(name=”sparse&quot;, description=&quot;Sparse laser scan&quot;, channel_name=”laser_scan_sparse”), Capability(name=&quot;dense&quot;, description=&quot;Dense laser scan&quot;, channel_name=”laser_scan_dense”)]
</pre></div>
</div>
<p>This list of capabilities will be passed to the <code class="docutils literal notranslate"><span class="pre">DataAcquisitionPluginService</span></code> class’s constructor and be used to respond to the <code class="docutils literal notranslate"><span class="pre">GetServiceInfo</span></code> RPC.</p>
</div>
<div class="section" id="data-collection-function">
<h3>Data Collection Function<a class="headerlink" href="#data-collection-function" title="Permalink to this headline">¶</a></h3>
<p>In addition to the capabilities, the plugin service must implement a data collection function, which will collect all requested data and store it in the data acquisition store service. This data collection function will run when the plugin service receives a <code class="docutils literal notranslate"><span class="pre">AcquirePluginData</span></code> RPC. The data collection function must have the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">data_collect_fn</span><span class="p">(</span><span class="n">request</span> <span class="p">:</span> <span class="n">AcquirePluginDataRequest</span><span class="p">,</span> <span class="n">store_helper</span> <span class="p">:</span>  <span class="n">DataAcquisitionStoreHelper</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">request</span></code> argument is the <code class="docutils literal notranslate"><span class="pre">AcquirePluginDataRequest</span></code>, which has the <code class="docutils literal notranslate"><span class="pre">acquisition_requests</span></code> field that contains a list of data captures that should be collected and saved by the plugin service. The <code class="docutils literal notranslate"><span class="pre">store_helper</span></code>argument is a <code class="docutils literal notranslate"><span class="pre">DataAcquisitionStoreHelper</span></code> which will be called to save the collected data.</p>
<p>It is important to note that the data collection function should <strong>block for the entire process</strong> of collecting the payload data and storing it in the data acquisition store service, and not return until all data is collected and has been stored.</p>
<p>The data collection function should perform the following things for each <code class="docutils literal notranslate"><span class="pre">DataCapture</span></code> requested in the <code class="docutils literal notranslate"><span class="pre">acquisition_requests</span></code> list passed as an argument to the function:</p>
<ol>
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">DataIdentifier</span></code> from the acquisition request’s <code class="docutils literal notranslate"><span class="pre">action_id</span></code> field. This data identifier will be stored with all of the collected data. If the same channel is used for all of the plugin’s data capabilities, then the <code class="docutils literal notranslate"><span class="pre">data_name</span></code> field should be populated with the data capture’s <code class="docutils literal notranslate"><span class="pre">name</span></code> field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_id</span> <span class="o">=</span> <span class="n">data_acquisition_pb2</span><span class="o">.</span><span class="n">DataIdentifier</span><span class="p">(</span><span class="n">action_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">action_id</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">CHANNEL_NAME</span><span class="p">,</span> <span class="n">data_name</span><span class="o">=</span><span class="n">DATA_NAME</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Collect the data by communicating with the payload.</p>
<ul class="simple">
<li><p>Note: Long-running acquisitions should be sure to call <code class="docutils literal notranslate"><span class="pre">store_helper.state.cancel_check()</span></code> occasionally to exit early and cleanly if the acquisition has been cancelled by the user or a timeout.</p></li>
</ul>
</li>
<li><p>Store the data in the data acquisition store service using the <code class="docutils literal notranslate"><span class="pre">store_helper</span></code>. The data can either be stored as <code class="docutils literal notranslate"><span class="pre">AssociatedMetadata</span></code>, which is json structured data, or as raw bytes data.</p></li>
<li><p>To save data as raw bytes, the <code class="docutils literal notranslate"><span class="pre">store_data</span></code> function is used.</p>
<ul class="simple">
<li><p>Tip: if the collected data is a protobuf message, the protobuf <code class="docutils literal notranslate"><span class="pre">SerializeToString()</span></code> function will convert the proto into bytes.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">store_helper</span><span class="o">.</span><span class="n">store_data</span><span class="p">(</span><span class="n">BYTES_DATA</span><span class="p">,</span> <span class="n">data_id</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>To save data as associated metadata, the <code class="docutils literal notranslate"><span class="pre">store_metadata</span></code> function is used. The <code class="docutils literal notranslate"><span class="pre">AssociatedMetadata</span></code> proto message is used to package the json data, and the <code class="docutils literal notranslate"><span class="pre">reference_id</span></code> of that proto should include the <code class="docutils literal notranslate"><span class="pre">request.action_id</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>message = data_acquisition_pb2.AssociatedMetadata()
message.reference_id.action_id.CopyFrom(request.action_id)
message.metadata.data.update({
    &quot;data&quot;: “special_data”
})
store_helper.store_metadata(message, data_id)
</pre></div>
</div>
</li>
</ol>
<p>Note, the <code class="docutils literal notranslate"><span class="pre">DataAcquisitionPluginService</span></code> class will wait to respond to the <code class="docutils literal notranslate"><span class="pre">AcquirePluginData</span></code> RPC until all data is collected and all store calls have been completed.</p>
</div>
<div class="section" id="example-plugins">
<h3>Example Plugins<a class="headerlink" href="#example-plugins" title="Permalink to this headline">¶</a></h3>
<p>There are a couple example plugin services which show data collection, creating associated metadata, and storing the data:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">python/examples/data_acquisition_service/plugins/piksi_metadata_plugin_service.py</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python/examples/data_acquisition_service/plugins/pointcloud_plugin_service.py</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python/examples/data_acquisition_service/plugins/gps_metadata_plugin_service.py</span></code></p></li>
</ul>
</div>
<div class="section" id="error-reporting">
<h3>Error Reporting<a class="headerlink" href="#error-reporting" title="Permalink to this headline">¶</a></h3>
<p>If a failure occurs in the plugin service, an error can be reported to the data acquisition service. If the collection of a specific piece of data fails, a <code class="docutils literal notranslate"><span class="pre">DataError</span></code> can be returned with the request’s specific <code class="docutils literal notranslate"><span class="pre">DataIdentifier</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>store_helper.state.add_errors([make_error(data_id, “Error Message!”)])
</pre></div>
</div>
<p>If the plugin service encounters an error that is unrelated to a specific piece of data, the data collection function can raise an <code class="docutils literal notranslate"><span class="pre">Exception</span></code>. This exception will be caught by the base <code class="docutils literal notranslate"><span class="pre">DataAcquisitionPluginService</span></code> class and will cause the <code class="docutils literal notranslate"><span class="pre">AcquirePluginData</span></code> RPC to respond with a <code class="docutils literal notranslate"><span class="pre">STATUS_INTERNAL_ERROR</span></code>. The data acquisition service will create a <code class="docutils literal notranslate"><span class="pre">PluginError</span></code> for this acquisition failure, which will appear in a <code class="docutils literal notranslate"><span class="pre">GetStatus</span></code> RPC sent to the data acquisition service.</p>
</div>
<div class="section" id="tips-for-creating-a-data-acquisition-plugin">
<h3>Tips for Creating a Data Acquisition Plugin<a class="headerlink" href="#tips-for-creating-a-data-acquisition-plugin" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Typically, a plugin will acquire all the requested data at once before storing any data with the <code class="docutils literal notranslate"><span class="pre">store_helper</span></code>. This allows a plugin to accurately set the status as <code class="docutils literal notranslate"><span class="pre">STATUS_SAVING</span></code> to indicate that all acquisitions are complete and provide feedback for the <code class="docutils literal notranslate"><span class="pre">GetStatus</span></code> RPC before beginning to store its data. As well, a plugin can check if it has been cancelled before saving any data to prevent accidentally storing data for a later cancelled request.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">store_helper</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">data_acquisition_pb2</span><span class="o">.</span><span class="n">GetStatusResponse</span><span class="o">.</span><span class="n">STATUS_SAVING</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>While developing a data acquisition plugin service, if the service is not behaving as expected or failing unexpectedly, a plugin tester program (<code class="docutils literal notranslate"><span class="pre">python/examples/data_acquisition_service/plugin_tester.py</span></code>) is available to help test and debug common failure modes through detailed display of the system’s outputs.</p></li>
<li><p>The data collection function can be part of its own class that manages state specific to the payload. Additionally, if an individual class is created for the data collection and management, it can use background threads to collect and buffer data to speed up the response to the <code class="docutils literal notranslate"><span class="pre">AcquirePluginData</span></code> RPC.</p></li>
<li><p>The data acquisition service will mark acquisition requests as <code class="docutils literal notranslate"><span class="pre">STATUS_TIMEDOUT</span></code> if they take longer than 30 seconds. A plugin can extend the timeout used by providing an additional function following this signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">acquire_response_fn</span><span class="p">(</span><span class="n">request</span><span class="p">:</span><span class="n">data_acquisition_pb2</span><span class="o">.</span><span class="n">AcquirePluginDataRequest</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span><span class="n">data_acquisition_pb2</span><span class="o">.</span><span class="n">AcquirePluginDataResponse</span><span class="p">):</span> <span class="n">returns</span> <span class="n">Boolean</span>
</pre></div>
</div>
<p>The acquire response function can verify the request header and check if the acquisition request is valid. If it is not, the <code class="docutils literal notranslate"><span class="pre">response</span></code> argument should be modified to set the <code class="docutils literal notranslate"><span class="pre">status</span></code> field. As well, the timeout can be extended for valid functions by updating the response’s <code class="docutils literal notranslate"><span class="pre">timeout_deadline</span></code> field. Note, the timeout should be set in the robot’s clock. Ultimately, the acquire response function will respond with a boolean indicating if the acquisition request is valid, and if so, the data collection will continue.</p>
</li>
<li><p>If a plugin’s data collection is slow, it should periodically check if the RPC is ever cancelled so that it can immediately stop the no longer necessary data collection. Within the data collection function, to check if a acquisition is cancelled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">store_helper</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">cancel_check</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Be careful using async functions within the data collection function for communicating with the payload. The service architecture expects the data collection process to block until all data is completely collected and stored.</p></li>
</ul>
</div>
</div>
<div class="section" id="directory-registration-and-running-the-new-service">
<h2>Directory Registration and Running the New Service<a class="headerlink" href="#directory-registration-and-running-the-new-service" title="Permalink to this headline">¶</a></h2>
<p>The new service, either a data acquisition plugin service or an image service, must be running and registered with the directory to communicate with the robot and the data acquisition service. This requires a unique service name, service type (“bosdyn.api.DataAcquisitionPluginService” or “bosdyn.api.ImageService”), and a service authority.</p>
<p>The payload computer running the new service should perform payload authentication using the GUID/secret of the payload before registering the service with the directory.</p>
</div>
<div class="section" id="testing-the-new-service">
<h2>Testing the New Service<a class="headerlink" href="#testing-the-new-service" title="Permalink to this headline">¶</a></h2>
<p>First, a developer can check that the service is successfully registered with the robot’s directory. The output to the following command should show the new service name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">bosdyn</span><span class="o">.</span><span class="n">client</span> <span class="o">--</span><span class="n">username</span> <span class="p">{</span><span class="n">USERNAME</span><span class="p">}</span>  <span class="o">--</span><span class="n">password</span> <span class="p">{</span><span class="n">PASSWORD</span><span class="p">}</span> <span class="p">{</span><span class="n">ROBOT_IP</span><span class="p">}</span> <span class="nb">dir</span> <span class="nb">list</span>
</pre></div>
</div>
<p>Next, to test the integration with the data acquisition service on robot, the command line client can be used to communicate with the robot and make requests for the plugin’s data sources or the image sources. Try the following command for more information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">bosdyn</span><span class="o">.</span><span class="n">client</span> <span class="p">{</span><span class="n">USERNAME</span><span class="p">}</span>  <span class="o">--</span><span class="n">password</span> <span class="p">{</span><span class="n">PASSWORD</span><span class="p">}</span> <span class="p">{</span><span class="n">ROBOT_IP</span><span class="p">}</span>  <span class="n">acquire</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<div class="section" id="testing-an-imageservice">
<h3>Testing an ImageService<a class="headerlink" href="#testing-an-imageservice" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../python/examples/get_image/README.html"><span class="doc">get_image example</span></a> can be used to test that the two RPCs can complete successfully for the new <code class="docutils literal notranslate"><span class="pre">ImageService</span></code>. The image service’s service name needs to be provided as an argument on the command line.</p>
<p>To test the <code class="docutils literal notranslate"><span class="pre">ListImageSources</span></code> RPC, run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">get_image</span>  <span class="o">--</span><span class="n">username</span> <span class="p">{</span><span class="n">USERNAME</span><span class="p">}</span>  <span class="o">--</span><span class="n">password</span> <span class="p">{</span><span class="n">PASSWORD</span><span class="p">}</span> <span class="p">{</span><span class="n">ROBOT_IP</span><span class="p">}</span>  <span class="o">--</span><span class="n">image</span><span class="o">-</span><span class="n">service</span> <span class="p">{</span><span class="n">SERVICE_NAME</span><span class="p">}</span> <span class="nb">list</span>
</pre></div>
</div>
<p>To test the <code class="docutils literal notranslate"><span class="pre">GetImage</span></code> RPC, run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">get_image</span>  <span class="o">--</span><span class="n">username</span> <span class="p">{</span><span class="n">USERNAME</span><span class="p">}</span>  <span class="o">--</span><span class="n">password</span> <span class="p">{</span><span class="n">PASSWORD</span><span class="p">}</span> <span class="p">{</span><span class="n">ROBOT_IP</span><span class="p">}</span>  <span class="o">--</span><span class="n">image</span><span class="o">-</span><span class="n">service</span> <span class="p">{</span><span class="n">SERVICE_NAME</span><span class="p">}</span> <span class="o">--</span><span class="n">image</span><span class="o">-</span><span class="n">sources</span> <span class="p">{</span><span class="n">SOURCE_NAME</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="testing-a-dataacquisitionpluginservice">
<h3>Testing a DataAcquisitionPluginService<a class="headerlink" href="#testing-a-dataacquisitionpluginservice" title="Permalink to this headline">¶</a></h3>
<p>To test the plugin service and ensure everything is implemented correctly and working, there is a <a class="reference internal" href="../../python/examples/data_acquisition_service/README.html"><span class="doc">plugin tester script</span></a>. The script checks the communication and registration of the new plugin service, as well as acquiring all advertised pieces of data and ensuring they get saved properly.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
      
      &copy; Copyright 2020 Boston Dynamics. All rights reserved.
      <a href="https://www.bostondynamics.com/privacy-statement">Privacy Statement</a> | 
      <a href="https://www.bostondynamics.com/terms">Terms of Use</a>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>